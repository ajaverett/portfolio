<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aj Averett">
<meta name="dcterms.date" content="2023-04-18">

<title>Aj’s Blog - Linear Regression Guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Aj’s Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About Aj</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ajaverett"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/ajaverett/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/rooftop_asian/"><i class="bi bi-instagram" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Linear Regression Guide</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Aj Averett </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 18, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="simple-linear-regression" class="level1">
<h1>Simple Linear Regression</h1>
<section id="true-y-observed-y-and-estimated-y" class="level2">
<h2 class="anchored" data-anchor-id="true-y-observed-y-and-estimated-y"><strong>True</strong> <span class="math inline">\(Y\)</span><strong>, Observed</strong> <span class="math inline">\(Y\)</span><strong>, and Estimated</strong> <span class="math inline">\(Y\)</span></h2>
<p>Simple linear regression means that there is only a single variable (not multiple <span class="math inline">\(X\)</span>’s)</p>
<ul>
<li><p><span class="math inline">\(X\)</span> - A single quantitative explanatory variable (independent)</p></li>
<li><p><span class="math inline">\(Y\)</span> - A single quantitative response variable (dependent)</p></li>
</ul>
<p>The <strong>True Regression Line</strong></p>
<p><span class="math display">\[
E\{Y\} = \beta_0 + \beta_1 X_i
\]</span></p>
<ul>
<li><p><span class="math inline">\(E\{Y\}\)</span> - True mean y-value, also <span class="math inline">\(\mu_{Y|X}\)</span> or <span class="math inline">\(E\{Y|X\}\)</span></p></li>
<li><p><span class="math inline">\(\beta_0\)</span> - True <span class="math inline">\(y\)</span>-intercept</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> - True slope</p></li>
</ul>
<p>The <strong>Observed Points</strong></p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i+ \epsilon_i = b_0 + b_1X_i + r_i
\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_i\)</span> - Response or dependent variable for the <span class="math inline">\(i^{\text{th}}\)</span> observation.</p></li>
<li><p><span class="math inline">\(\epsilon_i\)</span> - Error, distance of dot to true line. <span class="math inline">\(\epsilon_i = Y_i - E\{Y\}\)</span></p></li>
<li><p><span class="math inline">\(r_i\)</span> - Residual, distance of dot to estimated line. <span class="math inline">\(r_i = Y_i - \hat{Y}_i\)</span></p></li>
</ul>
<p>The <strong>Estimated Regression Line</strong> obtained from a regression analysis from the observed points</p>
<p><span class="math display">\[
\hat{Y}_i = b_0 + b_1 X_i
\]</span></p>
<ul>
<li><p><span class="math inline">\(\hat{Y}_i\)</span> - The fitted line</p></li>
<li><p><span class="math inline">\(b_0\)</span> - Estimated <span class="math inline">\(y\)</span>-intercept, also <span class="math inline">\(\hat{\beta}_0\)</span></p></li>
<li><p><span class="math inline">\(b_1\)</span> - Estimated slope, also <span class="math inline">\(\hat{\beta}_1\)</span></p></li>
</ul>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
R code for calling your data
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>wt, <span class="at">y=</span>mpg)) <span class="sc">+</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">'skyblue4'</span>, <span class="at">fill =</span> <span class="st">'skyblue'</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Miles per Gallon vs. Weight of Car"</span>, </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Weight of Car"</span>, </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="st">"Miles per Gallon"</span>) <span class="sc">+</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>mpg </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> mtcars<span class="sc">$</span>wt</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>i <span class="ot">&lt;-</span> <span class="dv">3</span> <span class="co">#random number</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>X[i]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.32</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>Y[i]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x=</span>wt, <span class="at">y=</span>mpg)) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">'skyblue4'</span>, <span class="at">fill =</span> <span class="st">'skyblue'</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Miles per Gallon vs. Weight of Car"</span>, </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">x=</span><span class="st">"Weight of Car"</span>, <span class="at">y=</span><span class="st">"Miles per Gallon"</span>) <span class="sc">+</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="fu">aes</span>(<span class="at">xintercept =</span> wt[i] ), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>) <span class="sc">+</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="fu">aes</span>(<span class="at">yintercept =</span> mpg[i]), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="residuals-and-the-sum-of-squared-errors" class="level2">
<h2 class="anchored" data-anchor-id="residuals-and-the-sum-of-squared-errors">Residuals and the Sum of Squared Errors</h2>
<p>The estimated regression line or line of best fit from the observed points is represented by the equation <span class="math inline">\(\hat{Y}_i=b_0+b_1X_i\)</span> , where <span class="math inline">\(b_1\)</span> is the estimated slope of the line and <span class="math inline">\(b_0\)</span> is the estimated y-intercept.</p>
<section id="minimizing-residuals" class="level3">
<h3 class="anchored" data-anchor-id="minimizing-residuals">Minimizing Residuals</h3>
<p>A single residual, <span class="math inline">\(r_i\)</span>, is the distance between an observed point and the estimated regression line. Given any line, we can calculate how different our predicted value, <span class="math inline">\(\hat{Y_i}\)</span> is from our actual data point, <span class="math inline">\(Y_i\)</span>. This vertical distance from the real y output and the predicted y output is called the residual. The formula for any given residual is represented as such</p>
<p><span class="math display">\[
\begin{align*}
r_i &amp;= Y_i-\hat{Y}_i\\
r_i &amp;= Y_i - (b_0+b_1X_i)
\end{align*}
\]</span></p>
<p>The goal of simple linear regression is to minimize the sum of the squared errors (<span class="math inline">\(\text{SSE}\)</span>). This is represented by the equations:</p>
<p><span class="math display">\[
\begin{align*}
\text{SSE} &amp;= \sum_{i=1}^n \left(r_i\right)^2 \\
\text{SSE} &amp;= \sum_{i=1}^n\left(Y_i - \hat{Y_i}\right)^2\\
\text{SSE} &amp;= \sum_{i=1}^n\left(Y_i - (b_0+b_1X_i)\right)^2
\end{align*}
\]</span></p>
<p>The closer any given line is to the best fit line, the lower the <span class="math inline">\(\text{SSE}\)</span> will be. In fact, the best fit line represents the line with the lowest possible <span class="math inline">\(\text{SSE}\)</span>. This line is found by manipulating the values for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> since the <span class="math inline">\(X\)</span> values must stay the same.</p>
</section>
</section>
<section id="calculating-the-estimated-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="calculating-the-estimated-regression-line">Calculating the Estimated Regression Line</h2>
<p>There are multiple ways to calculate the estimated regression line like with calculus or linear algebra.</p>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
The Calculus Behind Best Fit
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<section id="the-calculus-behind-best-fit-1" class="level1 callout-body-container callout-body">
<h1>The Calculus Behind Best Fit</h1>
<p>There exists a combination of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that is the lowest. Geometrically, we can imagine a shape in three dimensions where two inputs (<span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>) produce an output (<span class="math inline">\(\text{SSE}\)</span>). Roughly speaking, where the three dimensional slope is equal to 0 is where the combination of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> will produce the lowest possible <span class="math inline">\(\text{SSE}\)</span>. Since the derivative of an equation can tell us the slope at any given point, we can set both equations’ derivatives to zero to find where slope is zero for both equations.</p>
<p><strong>Step One: Take the partial derivatives with respect to</strong> <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span></p>
<p>The partial derivative with respect to <span class="math inline">\(b_0\)</span> is calculated as so:</p>
<p><span class="math display">\[\frac{\partial}{\partial b_0}\sum_{i=1}^n\left(Y_i - (b_0+b_1X_i)\right)^2\]</span> <span class="math display">\[
\begin{align*}
\mathscr{}
&amp;= \sum_{i=1}^n\frac{\partial}{\partial b_0}\left(Y_i - (b_0+b_1X_i)\right)^2  &amp;\text{Sum Rule}\\
&amp;= \sum_{i=1}^n2\left(Y_i - (b_0+b_1X_i)\right)\frac{\partial}{\partial b_0}\left(Y_i - (b_0+b_1X_i)\right) &amp;\text{Power Rule}\\
&amp;= \sum_{i=1}^n 2\left(Y_i - (b_0+b_1X_i)\right)(-1) &amp;\text{Simplify}\\
&amp;= -2\sum_{i=1}^n\left(Y_i - (b_0+b_1X_i)\right) &amp;\text{Constant Multiple Rule for Sums}
\end{align*}
\]</span></p>
<p>The partial derivative with respect to <span class="math inline">\(b_1\)</span> is calculated as so:</p>
<p><span class="math display">\[\frac{\partial}{\partial b_1}\sum_{i=1}^n\left(Y_i - (b_0+b_1X_i)\right)^2\]</span> <span class="math display">\[
\begin{align*}
\mathscr{}
&amp;= \sum_{i=1}^n\frac{\partial}{\partial b_1}\left(Y_i - (b_0+b_1X_i)\right)^2  &amp;\text{Sum Rule}\\
&amp;= \sum_{i=1}^n2\left(Y_i - (b_0+b_1X_i)\right)\frac{\partial}{\partial b_1}\left(Y_i - (b_0+b_1X_i)\right) &amp;\text{Power Rule}\\
&amp;= \sum_{i=1}^n 2\left(Y_i - (b_0+b_1X_i)\right)(-X_i) &amp;\text{Simplify}\\
&amp;= -2\sum_{i=1}^nX_i\left(Y_i - (b_0+b_1X_i)\right) &amp;\text{Constant Multiple Rule for Sums}
\end{align*}
\]</span></p>
<p><strong>Step Two: Set the simplified partial derivatives to zero and solve for</strong> <span class="math inline">\(b_0\)</span> <strong>and</strong> <span class="math inline">\(b_1\)</span> <strong>respectively</strong></p>
<p>Solving for <span class="math inline">\(b_0\)</span>: <span class="math display">\[0 = -2\sum_{i=1}^n\left(Y_i - (b_0+b_1X_i)\right)\]</span></p>
<p><span class="math display">\[
\begin{align*}
\mathscr{}
&amp;0 = \sum_{i=1}^n\left(Y_i - b_0-b_1x_i\right) &amp;\text{Simplify}\\
&amp;0 = \sum_{i=1}^nY_i - \sum_{i=1}^nb_0-\sum_{i=1}^nb_1X_i &amp;\text{Sum Rule}\\
&amp;0 = \sum_{i=1}^nY_i - nb_0-b_1\sum_{i=1}^nX_i &amp;\text{Constant Multiple Rule for Sums}\\
&amp; nb_0 = \sum_{i=1}^nY_i -b_1\sum_{i=1}^nX_i &amp;\text{Simplify}\\
&amp; b_0 = \frac{\sum_{i=1}^nY_i}{n} -\frac{b_1\sum_{i=1}^nX_i}{n} &amp;\text{Simplify}\\
&amp; b_0 = \bar{Y} - b_1\bar{X} &amp;\text{Simplify to average}\\
\end{align*}
\]</span></p>
<p>Solving for <span class="math inline">\(b_1\)</span> while substituting <span class="math inline">\(b_0\)</span>:</p>
<p><span class="math display">\[
0 = -2\sum_{i=1}^nX_i\left(Y_i - (b_0+b_1X_i)\right)
\]</span></p>
<p><span class="math display">\[
\begin{align*}
\mathscr{}
&amp;0 = \sum_{i=1}^nX_i\left(Y_i - ((\bar{Y} - b_1\bar{X})+b_1X_i)\right) &amp;\text{Substitute }b_0\\
&amp;0 = \sum_{i=1}^nX_i(Y_i-\bar{Y}) - \sum_{i=1}^nb_1X_i(X_i-\bar{X})&amp;\text{Sum Rule}\\
&amp;0 = \sum_{i=1}^nX_i(Y_i-\bar{Y}) - b_1\sum_{i=1}^nX_i(X_i-\bar{X})&amp;\text{Constant Multiple Rule for Sums}\\
&amp; b_1= \frac{\sum_{i=1}^nX_i(Y_i-\bar{Y})}{\sum_{i=1}^nX_i(X_i-\bar{X})} &amp;\text{Simplify}\\
&amp; b_1= \frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}{\sum_{i=1}^n(X_i-\bar{X})^2} &amp;\text{Simplify (steps skipped)}\\
\end{align*}
\]</span></p>
<p><strong>Step Three: Construct the formula</strong></p>
<p>Once you have found <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> as so:</p>
<ul>
<li><p><span class="math inline">\(b_0 = \bar{Y} - b_1\bar{X}\)</span></p></li>
<li><p><span class="math inline">\(b_1= \frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}{\sum_{i=1}^n(X_i-\bar{X})^2}\)</span></p></li>
</ul>
<p>(<span class="math inline">\(\bar{Y}\)</span> represents the mean of the <span class="math inline">\(Y\)</span> values and <span class="math inline">\(\bar{X}\)</span> represents the mean of the <span class="math inline">\(X\)</span> values)</p>
<p>We can construct the formula for <span class="math inline">\(\hat{Y}_i\)</span> as the following:</p>
<p><span class="math display">\[
\hat{Y}_i = b_0 + b_1X_i
\]</span></p>
<p>Which means <span class="math inline">\(b_0\)</span> is the change in the mean of <span class="math inline">\(Y\)</span> for a <span class="math inline">\(1\)</span> unit increase in <span class="math inline">\(X\)</span>.</p>
</section>
</div>
</div>
<div class="callout-tip callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
Least Squares in Linear Algebra
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<section id="least-squares-in-linear-algebra-1" class="level1 callout-body-container callout-body">
<h1>Least Squares in Linear Algebra</h1>
<p><strong>Step One: Organize the data into vectors</strong> Let’s assume you have <span class="math inline">\(n\)</span> observations of the independent variable <span class="math inline">\(\mathbf{X}\)</span> and dependent variable <span class="math inline">\(\mathbf{Y}\)</span>. Organize the data into two vectors:</p>
<p><span class="math display">\[
\mathbf{X} = \begin{bmatrix} X_1 \\ X_2 \\ \vdots \\ X_n \end{bmatrix}, \quad \mathbf{Y} = \begin{bmatrix} Y_1 \\ Y_2 \\ \vdots \\ Y_n \end{bmatrix}
\]</span></p>
<p><strong>Step Two: Create a design matrix</strong></p>
<p>Create a design matrix <span class="math inline">\(\mathbf{A}\)</span> by adding a column of ones to represent the intercept term</p>
<p><span class="math display">\[
\mathbf{A} = \begin{bmatrix} 1 &amp; X_1 \\ 1 &amp; X_2 \\ \vdots &amp; \vdots \\ 1 &amp; X_n \end{bmatrix}
\]</span></p>
<p><strong>Step Three: Make a Projection:</strong></p>
<p>The goal of simple linear regression is to find the best-fitting line, which can be viewed as projecting the dependent variable <span class="math inline">\(\mathbf{Y}\)</span> onto the column space of the design matrix <span class="math inline">\(\mathbf{A}\)</span>. This projection, denoted by <span class="math inline">\(\mathbf{\hat{Y}}\)</span>, can be computed as:</p>
<p><span class="math display">\[
\mathbf{\hat{Y}} = \mathbf{A}(\mathbf{A}^T\mathbf{A})^{-1}\mathbf{A}^T\mathbf{Y}
\]</span></p>
<p>This formula comes from the orthogonal projection of <span class="math inline">\(\mathbf{Y}\)</span> onto the column space of <span class="math inline">\(\mathbf{A}\)</span>, which minimizes the squared residuals.</p>
<p><strong>Step Four: Compute the coefficients:</strong></p>
<p>The coefficients of the best-fitting line can be found by solving the following linear system:</p>
<p><span class="math display">\[
\mathbf{A}^T\mathbf{A}\mathbf{\beta} = \mathbf{A}^T\mathbf{Y}
\]</span></p>
<p>Here, <span class="math inline">\(\mathbf{\beta}\)</span> is a vector containing the coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>:</p>
<p><span class="math display">\[
\mathbf{\beta} = \begin{bmatrix} \beta_0 \\ \beta_1 \end{bmatrix}
\]</span></p>
<p>To solve for <span class="math inline">\(\mathbf{\beta}\)</span>, you can use the following formula:</p>
<p><span class="math display">\[
\mathbf{\beta} = (\mathbf{A}^T\mathbf{A})^{-1}\mathbf{A}^T\mathbf{Y}
\]</span></p>
<p><strong>Step Five: Construct the formula:</strong></p>
<p>Once you have computed the coefficients <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>, you can write the estimated regression line as:</p>
<p><span class="math display">\[
\hat{Y}_i = \beta_0 + \beta_1 X_i
\]</span></p>
<p>The estimated slope, <span class="math inline">\(\beta_1\)</span>, indicates the average change in the dependent variable (<span class="math inline">\(Y\)</span>) for a one-unit increase in the independent variable (<span class="math inline">\(X\)</span>). The estimated intercept, <span class="math inline">\(\beta_0\)</span>, represents the predicted value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(X = 0\)</span>.</p>
</section>
</div>
</div>
<p>The formula from calculus to find the coefficients for the estimated regression line is as so:</p>
<ul>
<li><p><span class="math inline">\(b_0 = \bar{Y} - b_1\bar{X}\)</span></p></li>
<li><p><span class="math inline">\(b_1= \frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}{\sum_{i=1}^n(X_i-\bar{X})^2}\)</span></p></li>
</ul>
<p>(<span class="math inline">\(\bar{Y}\)</span> represents the mean of the <span class="math inline">\(Y\)</span> values and <span class="math inline">\(\bar{X}\)</span> represents the mean of the <span class="math inline">\(X\)</span> values)</p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
R code for calculating the coefficients for the estimated regression line
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>mylm <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">summary</span>(mylm))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="table table-sm table-striped">
<colgroup>
<col style="width: 25%">
<col style="width: 15%">
<col style="width: 18%">
<col style="width: 13%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">&nbsp;</th>
<th style="text-align: center;">Estimate</th>
<th style="text-align: center;">Std. Error</th>
<th style="text-align: center;">t value</th>
<th style="text-align: center;">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;"><strong>(Intercept)</strong></td>
<td style="text-align: center;">37.29</td>
<td style="text-align: center;">1.878</td>
<td style="text-align: center;">19.86</td>
<td style="text-align: center;">8.242e-19</td>
</tr>
<tr class="even">
<td style="text-align: center;"><strong>wt</strong></td>
<td style="text-align: center;">-5.344</td>
<td style="text-align: center;">0.5591</td>
<td style="text-align: center;">-9.559</td>
<td style="text-align: center;">1.294e-10</td>
</tr>
</tbody>
</table>
<table class="table table-sm table-striped">
<caption>Fitting linear model: mpg ~ wt</caption>
<colgroup>
<col style="width: 20%">
<col style="width: 30%">
<col style="width: 12%">
<col style="width: 23%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Observations</th>
<th style="text-align: center;">Residual Std. Error</th>
<th style="text-align: center;"><span class="math inline">\(R^2\)</span></th>
<th style="text-align: center;">Adjusted <span class="math inline">\(R^2\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">32</td>
<td style="text-align: center;">3.046</td>
<td style="text-align: center;">0.7528</td>
<td style="text-align: center;">0.7446</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>b_0 <span class="ot">&lt;-</span> mylm<span class="sc">$</span>coefficients[<span class="dv">1</span>]</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>b_1 <span class="ot">&lt;-</span> mylm<span class="sc">$</span>coefficients[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>b_0</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept) 
   37.28513 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>b_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       wt 
-5.344472 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(mtcars, <span class="fu">aes</span>(<span class="at">x =</span> wt, <span class="at">y =</span> mpg)) <span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_point</span>(<span class="at">shape =</span> <span class="dv">21</span>, <span class="at">color =</span> <span class="st">'skyblue4'</span>, <span class="at">fill =</span> <span class="st">'skyblue'</span>, <span class="at">size =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stat_function</span>(<span class="at">fun =</span> <span class="cf">function</span>(x) b_0 <span class="sc">+</span> b_1 <span class="sc">*</span> x) <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Miles per Gallon vs. Weight of Car"</span>, </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">x=</span><span class="st">"Weight of Car"</span>, </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">y=</span><span class="st">"Miles per Gallon"</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_classic</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="assumption-for-simple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="assumption-for-simple-linear-regression">Assumption for Simple Linear Regression</h2>
<p>If we are to make a model off the points displayed as such:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i+ \epsilon_i
\]</span></p>
<p>We need to confirm the following assumptions</p>
<ul>
<li><p><strong>1) Linear relation</strong>: Linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span></p></li>
<li><p><strong>2) Normal errors</strong>: <span class="math inline">\(\epsilon \sim \mathcal{N}(0,\sigma^2)\)</span>, the error terms are normally distributed with a mean of 0</p></li>
<li><p><strong>3) Constant variance</strong>: The variance&nbsp;<span class="math inline">\(σ^2\)</span> of the error terms is constant (the same) across all values of <span class="math inline">\(X_i\)</span></p></li>
<li><p><strong>4) Fixed</strong> <span class="math inline">\(X\)</span>: the <span class="math inline">\(X\)</span> values can be considered fixed and measured without error</p></li>
<li><p><strong>5) Independent errors</strong>: <span class="math inline">\(\epsilon\)</span> is independent</p></li>
</ul>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_1 X_i+ \epsilon_i :\epsilon \sim \mathcal{N}(0,\sigma^2)\)</span></p>
<p>Given <span class="math inline">\(X\)</span>, <span class="math inline">\(Y \sim \mathcal{N}(\beta_0 +\beta_1X,\sigma^2)\)</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
R code for testing the assumptions for simple linear regression
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Three plots in R can be used to test the assumptions for simple linear regression:</p>
<p><strong>Residuals versus Fitted-values Plot</strong> The linear relationship and constant variance assumptions can be diagnosed using a residuals versus fitted-values plot. The fitted values are the <span class="math inline">\(Y^i\)</span></p>
<ul>
<li><p>The residuals are the <span class="math inline">\(r_i\)</span></p></li>
<li><p>This plot compares the residual to the magnitude of the fitted-value. No discernable pattern in this plot is desirable.</p></li>
</ul>
<p><strong>Q-Q Plot of the Residuals</strong></p>
<p>The normality of the error terms can be assessed by considering a normal probability plot (Q-Q Plot) of the residuals. If the residuals appear to be normal, then the error terms are also considered to be normal. If the residuals do not appear to be normal, then the error terms are also assumed to violate the normality assumption.</p>
<p><strong>Residuals versus Order Plot</strong></p>
<p>When the data is collected in a specific order, or has some other important ordering to it, then the independence of the error terms can be assessed. This is typically done by plotting the residuals against their order of occurrance. If any dramatic trends are visible in the plot, then the independence assumption is violated.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>)) <span class="co">#Residuals versus Fitted-values Plot: Checks Assumptions #1 and #3</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mylm,<span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>) <span class="co">#Q-Q Plot of the Residuals: Checks Assumption #2</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(mylm<span class="sc">$</span>residuals) <span class="co">#Residuals versus Order Plot: Checks Assumption #5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="assessing-the-estimated-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="assessing-the-estimated-regression-line">Assessing the Estimated Regression Line</h2>
<section id="terms" class="level3">
<h3 class="anchored" data-anchor-id="terms">Terms</h3>
<p><strong>Sum of Squared Errors</strong></p>
<p>Measures how much the residuals deviate from the line.</p>
<p><span class="math inline">\(\text{SSE} = \sum_{i=1}^n \left(r_i\right)^2 = \sum_{i=1}^n\left(Y_i - \hat{Y_i}\right)^2\)</span></p>
<p><strong>Sum of Squares Regression</strong></p>
<p>Measures how much the regression line deviates from the average y-value.</p>
<p><span class="math inline">\(\text{SSR} = \sum_{i=1}^n \left(r_i\right)^2 = \sum_{i=1}^n\left(\hat{Y}_i - \bar{Y}\right)^2\)</span></p>
<p><strong>Total Sum of Squares</strong></p>
<p>Measures how much the y-values deviate from the average y-value.</p>
<p><span class="math inline">\(\text{SSTO} = \sum_{i=1}^n \left(Y_i - \bar{Y}\right)^2\)</span></p>
<p><img src="images/paste-1.png" class="img-fluid" width="544"></p>
<p><span class="math inline">\(\text{SSTO}=\text{SSE}+\text{SSR}\)</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
R code for calculating the above terms
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>residuals <span class="ot">&lt;-</span> mylm<span class="sc">$</span>residuals</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fitted_values <span class="ot">&lt;-</span> mylm<span class="sc">$</span>fitted.values</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>mean_mpg <span class="ot">&lt;-</span> <span class="fu">mean</span>(mtcars<span class="sc">$</span>mpg)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>SSE <span class="ot">&lt;-</span> <span class="fu">sum</span>(residuals<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>SSR <span class="ot">&lt;-</span> <span class="fu">sum</span>((fitted_values <span class="sc">-</span> mean_mpg)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>TSS <span class="ot">&lt;-</span> <span class="fu">sum</span>((mtcars<span class="sc">$</span>mpg <span class="sc">-</span> mean_mpg)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">cat</span>(<span class="st">"Sum of Squared Errors (SSE):"</span>, SSE, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p>Sum of Squared Errors (SSE): 278.3219</p>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">cat</span>(<span class="st">"Sum of Squares Regression (SSR):"</span>, SSR, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p>Sum of Squares Regression (SSR): 847.7252</p>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(<span class="fu">cat</span>(<span class="st">"Total Sum of Squares (TSS):"</span>, TSS, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p>Total Sum of Squares (TSS): 1126.047</p>
</div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="calculating-the-coefficient-of-determination" class="level2">
<h2 class="anchored" data-anchor-id="calculating-the-coefficient-of-determination">Calculating the Coefficient of Determination</h2>
<p>Using the terms above, we can calculate a ratio of the variance of <span class="math inline">\(Y\)</span> explained by the estimated regression line (<span class="math inline">\(\text{SSE}\)</span>) and the total variance of <span class="math inline">\(Y\)</span> from the average <span class="math inline">\(Y\)</span> value (<span class="math inline">\(\text{SSTO}\)</span>.</p>
<p><span class="math display">\[
R^2 = 1-\frac{\text{SSE}}{\text{SSTO}}
\]</span></p>
<div class="callout-note callout callout-style-default callout-captioned">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-caption-container flex-fill">
R code for calculating the coefficient of determination
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>lm_summary <span class="ot">&lt;-</span> <span class="fu">summary</span>(mylm)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>pander<span class="sc">::</span><span class="fu">pander</span>(lm_summary<span class="sc">$</span>r.squared)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><em>0.7528</em></p>
</div>
</div>
</div>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>