<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Aj Averett">
<meta name="dcterms.date" content="2023-04-18">

<title>Aj’s Blog - Linear Regression Guide</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Aj’s Blog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About Aj</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/ajaverett"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/ajaverett/"><i class="bi bi-linkedin" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.instagram.com/rooftop_asian/"><i class="bi bi-instagram" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Linear Regression Guide</h1>
                                <div class="quarto-categories">
                <div class="quarto-category">statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Aj Averett </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 18, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="simple-linear-regression" class="level1">
<h1>Simple Linear Regression</h1>
<section id="true-y-observed-y-and-estimated-y" class="level2">
<h2 class="anchored" data-anchor-id="true-y-observed-y-and-estimated-y"><strong>True</strong> <span class="math inline">\(Y\)</span><strong>, Observed</strong> <span class="math inline">\(Y\)</span><strong>, and Estimated</strong> <span class="math inline">\(Y\)</span></h2>
<p>Simple linear regression means that there is only a single variable (not multiple <span class="math inline">\(X\)</span>’s)</p>
<ul>
<li><p><span class="math inline">\(X\)</span> - A single quantitative explanatory variable (independent)</p></li>
<li><p><span class="math inline">\(Y\)</span> - A single quantitative response variable (dependent)</p></li>
</ul>
<p>The <strong>True Regression Line</strong></p>
<p><span class="math display">\[
E\{Y\} = \beta_0 + \beta_1 X_i
\]</span></p>
<ul>
<li><p><span class="math inline">\(E\{Y\}\)</span> - True mean y-value, also <span class="math inline">\(\mu_{Y|X}\)</span> or <span class="math inline">\(E\{Y|X\}\)</span></p></li>
<li><p><span class="math inline">\(\beta_0\)</span> - True <span class="math inline">\(y\)</span>-intercept</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> - True slope</p></li>
</ul>
<p>The <strong>Observed Points</strong></p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i+ \epsilon_i = b_0 + b_1X_i + r_i
\]</span></p>
<ul>
<li><p><span class="math inline">\(Y_i\)</span> - Response or dependent variable for the <span class="math inline">\(i^{\text{th}}\)</span> observation.</p></li>
<li><p><span class="math inline">\(\epsilon_i\)</span> - Error, distance of dot to true line. <span class="math inline">\(\epsilon_i = Y_i - E\{Y\}\)</span></p></li>
<li><p><span class="math inline">\(r_i\)</span> - Residual, distance of dot to estimated line. <span class="math inline">\(r_i = Y_i - \hat{Y}_i\)</span></p></li>
</ul>
<p>The <strong>Estimated Regression Line</strong> obtained from a regression analysis from the observed points</p>
<p><span class="math display">\[
\hat{Y}_i = b_0 + b_1 X_i
\]</span></p>
<ul>
<li><p><span class="math inline">\(\hat{Y}_i\)</span> - The fitted line</p></li>
<li><p><span class="math inline">\(b_0\)</span> - Estimated <span class="math inline">\(y\)</span>-intercept, also <span class="math inline">\(\hat{\beta}_0\)</span></p></li>
<li><p><span class="math inline">\(b_1\)</span> - Estimated slope, also <span class="math inline">\(\hat{\beta}_1\)</span></p></li>
</ul>
</section>
<section id="assumption-for-simple-linear-regression" class="level2">
<h2 class="anchored" data-anchor-id="assumption-for-simple-linear-regression">Assumption for Simple Linear Regression</h2>
<p>If we are to make a model off the points displayed as such:</p>
<p><span class="math display">\[
Y_i = \beta_0 + \beta_1 X_i+ \epsilon_i
\]</span></p>
<p>We need to confirm the following assumptions</p>
<ul>
<li><p><strong>1) Linear relation</strong>: Linear relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span></p></li>
<li><p><strong>2) Normal errors</strong>: <span class="math inline">\(\epsilon \sim \mathcal{N}(0,\sigma^2)\)</span>, the error terms are normally distributed with a mean of 0</p></li>
<li><p><strong>3) Constant variance</strong>: The variance&nbsp;<span class="math inline">\(σ^2\)</span> of the error terms is constant (the same) across all values of <span class="math inline">\(X_i\)</span></p></li>
<li><p><strong>4) Fixed</strong> <span class="math inline">\(X\)</span>: the <span class="math inline">\(X\)</span> values can be considered fixed and measured without error</p></li>
<li><p><strong>5) Independent errors</strong>: <span class="math inline">\(\epsilon\)</span> is independent</p></li>
</ul>
<p><span class="math inline">\(Y_i = \beta_0 + \beta_1 X_i+ \epsilon_i :\epsilon \sim \mathcal{N}(0,\sigma^2)\)</span></p>
<p>Given <span class="math inline">\(X\)</span>, <span class="math inline">\(Y \sim \mathcal{N}(\beta_0 +\beta_1X,\sigma^2)\)</span></p>
</section>
<section id="making-the-estimated-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="making-the-estimated-regression-line">Making the Estimated Regression Line</h2>
<p>The estimated regression line or line of best fit from the observed points is represented by the equation <span class="math inline">\(\hat{Y}_i=b_0+b_1X_i\)</span> , where <span class="math inline">\(b_1\)</span> is the estimated slope of the line and <span class="math inline">\(b_0\)</span> is the estimated y-intercept.</p>
<section id="minimizing-residuals" class="level3">
<h3 class="anchored" data-anchor-id="minimizing-residuals">Minimizing Residuals</h3>
<p>A single residual, <span class="math inline">\(r_i\)</span>, is the distance between an observed point and the estimated regression line. Given any line, we can calculate how different our predicted value, <span class="math inline">\(\hat{Y_i}\)</span> is from our actual data point, <span class="math inline">\(Y_i\)</span>. This vertical distance from the real y output and the predicted y output is called the residual. The formula for any given residual is represented as such</p>
<p><span class="math display">\[
\begin{align*}
r_i &amp;= Y_i-\hat{Y}_i\\
r_i &amp;= Y_i - (b_0+b_1X_i)
\end{align*}
\]</span></p>
<p>The goal of simple linear regression is to minimize the sum of the squared errors (<span class="math inline">\(\text{SSE}\)</span>). This is represented by the equations:</p>
<p><span class="math display">\[
\begin{align*}
\text{SSE} &amp;= \sum_{i=1}^n \left(r_i\right)^2 \\
\text{SSE} &amp;= \sum_{i=1}^n\left(Y_i - \hat{Y_i}\right)^2\\
\text{SSE} &amp;= \sum_{i=1}^n\left(Y_i - (b_0+b_1X_i)\right)^2
\end{align*}
\]</span></p>
<p>The closer any given line is to the best fit line, the lower the <span class="math inline">\(\text{SSE}\)</span> will be. In fact, the best fit line represents the line with the lowest possible <span class="math inline">\(\text{SSE}\)</span>. This line is found by manipulating the values for <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> since the <span class="math inline">\(X\)</span> values must stay the same.</p>
</section>
<section id="the-calculus-behind-best-fit" class="level3">
<h3 class="anchored" data-anchor-id="the-calculus-behind-best-fit">The Calculus Behind Best Fit</h3>
<p>There exists a combination of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> that is the lowest. Geometrically, we can imagine a shape in three dimensions where two inputs (<span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span>) produce an output (<span class="math inline">\(\text{SSE}\)</span>). Roughly speaking, where the three dimensional slope is equal to 0 is where the combination of <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> will produce the lowest possible <span class="math inline">\(\text{SSE}\)</span>. Since the derivative of an equation can tell us the slope at any given point, we can set both equations’ derivatives to zero to find where slope is zero for both equations.</p>
<p><strong>Step One: Take the partial derivatives with respect to</strong> <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span></p>
<p>The partial derivative with respect to <span class="math inline">\(b_0\)</span> is calculated as so:</p>
<p><span class="math display">\[\frac{\partial}{\partial b_0}\sum_{i=1}^n\left(Y_i - (b_0+b_1X_i)\right)^2\]</span> <span class="math display">\[
\begin{align*}
\mathscr{}
&amp;= \sum_{i=1}^n\frac{\partial}{\partial b_0}\left(Y_i - (b_0+b_1X_i)\right)^2  &amp;\text{Sum Rule}\\
&amp;= \sum_{i=1}^n2\left(Y_i - (b_0+b_1X_i)\right)\frac{\partial}{\partial b_0}\left(Y_i - (b_0+b_1X_i)\right) &amp;\text{Power Rule}\\
&amp;= \sum_{i=1}^n 2\left(Y_i - (b_0+b_1X_i)\right)(-1) &amp;\text{Simplify}\\
&amp;= -2\sum_{i=1}^n\left(Y_i - (b_0+b_1X_i)\right) &amp;\text{Constant Multiple Rule for Sums}
\end{align*}
\]</span></p>
<p>The partial derivative with respect to <span class="math inline">\(b_1\)</span> is calculated as so:</p>
<p><span class="math display">\[\frac{\partial}{\partial b_1}\sum_{i=1}^n\left(Y_i - (b_0+b_1X_i)\right)^2\]</span> <span class="math display">\[
\begin{align*}
\mathscr{}
&amp;= \sum_{i=1}^n\frac{\partial}{\partial b_1}\left(Y_i - (b_0+b_1X_i)\right)^2  &amp;\text{Sum Rule}\\
&amp;= \sum_{i=1}^n2\left(Y_i - (b_0+b_1X_i)\right)\frac{\partial}{\partial b_1}\left(Y_i - (b_0+b_1X_i)\right) &amp;\text{Power Rule}\\
&amp;= \sum_{i=1}^n 2\left(Y_i - (b_0+b_1X_i)\right)(-X_i) &amp;\text{Simplify}\\
&amp;= -2\sum_{i=1}^nX_i\left(Y_i - (b_0+b_1X_i)\right) &amp;\text{Constant Multiple Rule for Sums}
\end{align*}
\]</span></p>
<p><strong>Step Two: Set the simplified partial derivatives to zero and solve for</strong> <span class="math inline">\(b_0\)</span> <strong>and</strong> <span class="math inline">\(b_1\)</span> <strong>respectively</strong></p>
<p>Solving for <span class="math inline">\(b_0\)</span>: <span class="math display">\[0 = -2\sum_{i=1}^n\left(Y_i - (b_0+b_1X_i)\right)\]</span></p>
<p><span class="math display">\[
\begin{align*}
\mathscr{}
&amp;0 = \sum_{i=1}^n\left(Y_i - b_0-b_1x_i\right) &amp;\text{Simplify}\\
&amp;0 = \sum_{i=1}^nY_i - \sum_{i=1}^nb_0-\sum_{i=1}^nb_1X_i &amp;\text{Sum Rule}\\
&amp;0 = \sum_{i=1}^nY_i - nb_0-b_1\sum_{i=1}^nX_i &amp;\text{Constant Multiple Rule for Sums}\\
&amp; nb_0 = \sum_{i=1}^nY_i -b_1\sum_{i=1}^nX_i &amp;\text{Simplify}\\
&amp; b_0 = \frac{\sum_{i=1}^nY_i}{n} -\frac{b_1\sum_{i=1}^nX_i}{n} &amp;\text{Simplify}\\
&amp; b_0 = \bar{Y} - b_1\bar{X} &amp;\text{Simplify to average}\\
\end{align*}
\]</span></p>
<p>Solving for <span class="math inline">\(b_1\)</span> while substituting <span class="math inline">\(b_0\)</span>:</p>
<p><span class="math display">\[0 = -2\sum_{i=1}^nX_i\left(Y_i - (b_0+b_1X_i)\right)\]</span> <span class="math display">\[
\begin{align*}
\mathscr{}
&amp;0 = \sum_{i=1}^nX_i\left(Y_i - ((\bar{Y} - b_1\bar{X})+b_1X_i)\right) &amp;\text{Substitute }b_0\\
&amp;0 = \sum_{i=1}^nX_i(Y_i-\bar{Y}) - \sum_{i=1}^nb_1X_i(X_i-\bar{X})&amp;\text{Sum Rule}\\
&amp;0 = \sum_{i=1}^nX_i(Y_i-\bar{Y}) - b_1\sum_{i=1}^nX_i(X_i-\bar{X})&amp;\text{Constant Multiple Rule for Sums}\\
&amp; b_1= \frac{\sum_{i=1}^nX_i(Y_i-\bar{Y})}{\sum_{i=1}^nX_i(X_i-\bar{X})} &amp;\text{Simplify}\\
&amp; b_1= \frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}{\sum_{i=1}^n(X_i-\bar{X})^2} &amp;\text{Simplify (steps skipped)}\\
\end{align*}
\]</span></p>
<p><strong>Step Three: Construct the formula</strong></p>
<p>Once you have found <span class="math inline">\(b_0\)</span> and <span class="math inline">\(b_1\)</span> as so:</p>
<ul>
<li><p><span class="math inline">\(b_0 = \bar{Y} - b_1\bar{X}\)</span></p></li>
<li><p><span class="math inline">\(b_1= \frac{\sum_{i=1}^n(X_i-\bar{X})(Y_i-\bar{Y})}{\sum_{i=1}^n(X_i-\bar{X})^2}\)</span></p></li>
</ul>
<p>(<span class="math inline">\(\bar{Y}\)</span> represents the mean of the <span class="math inline">\(Y\)</span> values and <span class="math inline">\(\bar{X}\)</span> represents the mean of the <span class="math inline">\(X\)</span> values)</p>
<p>We can construct the formula for <span class="math inline">\(\hat{Y}_i\)</span> as the following:</p>
<p><span class="math display">\[\hat{Y}_i = b_0 + b_1X_i\]</span> Which means <span class="math inline">\(b_0\)</span> is the change in the mean of <span class="math inline">\(Y\)</span> for a <span class="math inline">\(1\)</span> unit increase in <span class="math inline">\(X\)</span>.</p>
</section>
</section>
<section id="assessing-the-estimated-regression-line" class="level2">
<h2 class="anchored" data-anchor-id="assessing-the-estimated-regression-line">Assessing the Estimated Regression Line</h2>
<section id="terms" class="level3">
<h3 class="anchored" data-anchor-id="terms">Terms</h3>
<p><strong>Sum of Squared Errors</strong></p>
<p>Measures how much the residuals deviate from the line.</p>
<p><span class="math inline">\(\text{SSE} = \sum_{i=1}^n \left(r_i\right)^2 = \sum_{i=1}^n\left(Y_i - \hat{Y_i}\right)^2\)</span></p>
<p><strong>Sum of Squares Regression</strong></p>
<p>Measures how much the regression line deviates from the average y-value.</p>
<p><span class="math inline">\(\text{SSR} = \sum_{i=1}^n \left(r_i\right)^2 = \sum_{i=1}^n\left(\hat{Y}_i - \bar{Y}\right)^2\)</span></p>
<p><strong>Total Sum of Squares</strong></p>
<p>Measures how much the y-values deviate from the average y-value.</p>
<p><span class="math inline">\(\text{SSTO} = \sum_{i=1}^n \left(Y_i - \bar{Y}\right)^2\)</span></p>
<p><img src="images/paste-1.png" class="img-fluid" width="544"></p>
<p><span class="math inline">\(\text{SSTO}=\text{SSE}+\text{SSR}\)</span></p>
</section>
<section id="calculating-the-coefficient-of-determination" class="level3">
<h3 class="anchored" data-anchor-id="calculating-the-coefficient-of-determination">Calculating the Coefficient of Determination</h3>
<p>Using the terms above, we can calculate a ratio of the variance of <span class="math inline">\(Y\)</span> explained by the estimated regression line (<span class="math inline">\(\text{SSE}\)</span>) and the total variance of <span class="math inline">\(Y\)</span> from the average <span class="math inline">\(Y\)</span> value (<span class="math inline">\(\text{SSTO}\)</span>.</p>
<p><span class="math display">\[
R^2 = 1-\frac{\text{SSE}}{\text{SSTO}}
\]</span></p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>